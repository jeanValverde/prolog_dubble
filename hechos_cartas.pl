%hechos 
%carta(numeroCarta, NumE, [Indices] )

%para set completos de cartas NumE 2 
carta(1,2, [1,2]).
carta(2,2, [1,3]).
carta(3,2, [2,3]).

carta(1,3, [1,2,3]).
carta(2,3, [1,4,5]).
carta(3,3, [1,6,7]).
carta(4,3, [2,4,6]).
carta(5,3, [2,5,7]).
carta(6,3, [3,4,7]).
carta(7,3, [3,5,6]).

carta(1,4, [1,2,3,4]).
carta(2,4, [1,5,6,7]).
carta(3,4, [1,8,9,10]).
carta(4,4, [1,11,12,13]).
carta(5,4, [2,5,8,11]).
carta(6,4, [2,6,9,12]).
carta(7,4, [2,7,10,13]).
carta(8,4, [3,5,9,13]).
carta(9,4, [3,6,10,11]).
carta(10,4, [3,7,8,12]).
carta(11,4, [4,5,10,12]).
carta(12,4, [4,6,8,13]).
carta(13,4, [4,7,9,11]).

carta(1,6, [1,2,3,4,5,6]).
carta(2,6, [1,7,8,9,10,11]).
carta(3,6, [1,12,13,14,15,16]).
carta(4,6, [1,17,18,19,20,21]).
carta(5,6, [1,22,23,24,25,26]).
carta(6,6, [1,27,28,29,30,31]).
carta(7,6, [2,7,12,17,22,27]).
carta(8,6, [2,8,13,18,23,28]).
carta(9,6, [2,9,14,19,24,29]).
carta(10,6, [2,10,15,20,25,30]).
carta(11,6, [2,11,16,21,26,31]).
carta(12,6, [3,7,13,19,25,31]).
carta(13,6, [3,8,14,20,26,27]).
carta(14,6, [3,9,15,21,22,28]).
carta(15,6, [3,10,16,17,23,29]).
carta(16,6, [3,11,12,18,24,30]).
carta(17,6, [4,7,14,21,23,30]).
carta(18,6, [4,8,15,17,24,31]).
carta(19,6, [4,9,16,18,25,27]).
carta(20,6, [4,10,12,19,26,28]).
carta(21,6, [4,11,13,20,22,29]).
carta(22,6, [5,7,15,18,26,29]).
carta(23,6, [5,8,16,19,22,30]).
carta(24,6, [5,9,12,20,23,31]).
carta(25,6, [5,10,13,21,24,27]).
carta(26,6, [5,11,14,17,25,28]).
carta(27,6, [6,7,16,20,24,28]).
carta(28,6, [6,8,12,21,25,29]).
carta(29,6, [6,9,13,17,26,30]).
carta(30,6, [6,10,14,18,22,31]).
carta(31,6, [6,11,15,19,23,27]).

carta(1,7, [1,2,3,4,5,6,7]).
carta(2,7, [1,8,9,10,11,12,13]).
carta(3,7, [1,14,15,16,17,18,19]).
carta(4,7, [1,20,21,22,23,24,25]).
carta(5,7, [1,26,27,28,29,30,31]).
carta(6,7, [1,32,33,34,35,36,37]).
carta(7,7, [1,38,39,40,41,42,43]).
carta(8,7, [2,8,14,20,26,32,38]).
carta(9,7, [2,9,15,21,27,33,39]).
carta(10,7, [2,10,16,22,28,34,40]).
carta(11,7, [2,11,17,23,29,35,41]).
carta(12,7, [2,12,18,24,30,36,42]).
carta(13,7, [2,13,19,25,31,37,43]).
carta(14,7, [3,8,15,22,29,36,43]).
carta(15,7, [3,9,16,23,30,37,38]).
carta(16,7, [3,10,17,24,31,32,39]).
carta(17,7, [3,11,18,25,26,33,40]).
carta(18,7, [3,12,19,20,27,34,41]).
carta(19,7, [3,13,14,21,28,35,42]).
carta(20,7, [4,8,16,24,26,34,42]).
carta(21,7, [4,9,17,25,27,35,43]).
carta(22,7, [4,10,18,20,28,36,38]).
carta(23,7, [4,11,19,21,29,37,39]).
carta(24,7, [4,12,14,22,30,32,40]).
carta(25,7, [4,13,15,23,31,33,41]).
carta(26,7, [5,8,17,20,29,32,41]).
carta(27,7, [5,9,18,21,30,33,42]).
carta(28,7, [5,10,19,22,31,34,43]).
carta(29,7, [5,11,14,23,26,35,38]).
carta(30,7, [5,12,15,24,27,36,39]).
carta(31,7, [5,13,16,25,28,37,40]).
carta(32,7, [6,8,18,22,26,36,40]).
carta(33,7, [6,9,19,23,27,37,41]).
carta(34,7, [6,10,14,24,28,32,42]).
carta(35,7, [6,11,15,25,29,33,43]).
carta(36,7, [6,12,16,20,30,34,38]).
carta(37,7, [6,13,17,21,31,35,39]).
carta(38,7, [7,8,19,24,29,34,39]).
carta(39,7, [7,9,14,25,30,35,40]).
carta(40,7, [7,10,15,20,31,36,41]).
carta(41,7, [7,11,16,21,26,37,42]).
carta(42,7, [7,12,17,22,27,32,43]).
carta(43,7, [7,13,18,23,28,33,38]).

carta(1,8, [1,2,3,4,5,6,7,8]).
carta(2,8, [1,9,10,11,12,13,14,15]).
carta(3,8, [1,16,17,18,19,20,21,22]).
carta(4,8, [1,23,24,25,26,27,28,29]).
carta(5,8, [1,30,31,32,33,34,35,36]).
carta(6,8, [1,37,38,39,40,41,42,43]).
carta(7,8, [1,44,45,46,47,48,49,50]).
carta(8,8, [1,51,52,53,54,55,56,57]).
carta(9,8, [2,9,16,23,30,37,44,51]).
carta(10,8, [2,10,17,24,31,38,45,52]).
carta(11,8, [2,11,18,25,32,39,46,53]).
carta(12,8, [2,12,19,26,33,40,47,54]).
carta(13,8, [2,13,20,27,34,41,48,55]).
carta(14,8, [2,14,21,28,35,42,49,56]).
carta(15,8, [2,15,22,29,36,43,50,57]).
carta(16,8, [3,9,17,25,33,41,49,57]).
carta(17,8, [3,10,18,26,34,42,50,51]).
carta(18,8, [3,11,19,27,35,43,44,52]).
carta(19,8, [3,12,20,28,36,37,45,53]).
carta(20,8, [3,13,21,29,30,38,46,54]).
carta(21,8, [3,14,22,23,31,39,47,55]).
carta(22,8, [3,15,16,24,32,40,48,56]).
carta(23,8, [4,9,18,27,36,38,47,56]).
carta(24,8, [4,10,19,28,30,39,48,57]).
carta(25,8, [4,11,20,29,31,40,49,51]).
carta(26,8, [4,12,21,23,32,41,50,52]).
carta(27,8, [4,13,22,24,33,42,44,53]).
carta(28,8, [4,14,16,25,34,43,45,54]).
carta(29,8, [4,15,17,26,35,37,46,55]).
carta(30,8, [5,9,19,29,32,42,45,55]).
carta(31,8, [5,10,20,23,33,43,46,56]).
carta(32,8, [5,11,21,24,34,37,47,57]).
carta(33,8, [5,12,22,25,35,38,48,51]).
carta(34,8, [5,13,16,26,36,39,49,52]).
carta(35,8, [5,14,17,27,30,40,50,53]).
carta(36,8, [5,15,18,28,31,41,44,54]).
carta(37,8, [6,9,20,24,35,39,50,54]).
carta(38,8, [6,10,21,25,36,40,44,55]).
carta(39,8, [6,11,22,26,30,41,45,56]).
carta(40,8, [6,12,16,27,31,42,46,57]).
carta(41,8, [6,13,17,28,32,43,47,51]).
carta(42,8, [6,14,18,29,33,37,48,52]).
carta(43,8, [6,15,19,23,34,38,49,53]).
carta(44,8, [7,9,21,26,31,43,48,53]).
carta(45,8, [7,10,22,27,32,37,49,54]).
carta(46,8, [7,11,16,28,33,38,50,55]).
carta(47,8, [7,12,17,29,34,39,44,56]).
carta(48,8, [7,13,18,23,35,40,45,57]).
carta(49,8, [7,14,19,24,36,41,46,51]).
carta(50,8, [7,15,20,25,30,42,47,52]).
carta(51,8, [8,9,22,28,34,40,46,52]).
carta(52,8, [8,10,16,29,35,41,47,53]).
carta(53,8, [8,11,17,23,36,42,48,54]).
carta(54,8, [8,12,18,24,30,43,49,55]).
carta(55,8, [8,13,19,25,31,37,50,56]).
carta(56,8, [8,14,20,26,32,38,44,57]).
carta(57,8, [8,15,21,27,33,39,45,51]).

carta(1,10, [1,2,3,4,5,6,7,8,9,10]).
carta(2,10, [1,11,12,13,14,15,16,17,18,19]).
carta(3,10, [1,20,21,22,23,24,25,26,27,28]).
carta(4,10, [1,29,30,31,32,33,34,35,36,37]).
carta(5,10, [1,38,39,40,41,42,43,44,45,46]).
carta(6,10, [1,47,48,49,50,51,52,53,54,55]).
carta(7,10, [1,56,57,58,59,60,61,62,63,64]).
carta(8,10, [1,65,66,67,68,69,70,71,72,73]).
carta(9,10, [1,74,75,76,77,78,79,80,81,82]).
carta(10,10, [1,83,84,85,86,87,88,89,90,91]).
carta(11,10, [2,11,20,29,38,47,56,65,74,83]).
carta(12,10, [2,12,21,30,39,48,57,66,75,84]).
carta(13,10, [2,13,22,31,40,49,58,67,76,85]).
carta(14,10, [2,14,23,32,41,50,59,68,77,86]).
carta(15,10, [2,15,24,33,42,51,60,69,78,87]).
carta(16,10, [2,16,25,34,43,52,61,70,79,88]).
carta(17,10, [2,17,26,35,44,53,62,71,80,89]).
carta(18,10, [2,18,27,36,45,54,63,72,81,90]).
carta(19,10, [2,19,28,37,46,55,64,73,82,91]).
carta(20,10, [3,11,21,31,41,51,61,71,81,91]).
carta(21,10, [3,12,22,32,42,52,62,72,82,83]).
carta(22,10, [3,13,23,33,43,53,63,73,74,84]).
carta(23,10, [3,14,24,34,44,54,64,65,75,85]).
carta(24,10, [3,15,25,35,45,55,56,66,76,86]).
carta(25,10, [3,16,26,36,46,47,57,67,77,87]).
carta(26,10, [3,17,27,37,38,48,58,68,78,88]).
carta(27,10, [3,18,28,29,39,49,59,69,79,89]).
carta(28,10, [3,19,20,30,40,50,60,70,80,90]).
carta(29,10, [4,11,22,33,44,55,57,68,79,90]).
carta(30,10, [4,12,23,34,45,47,58,69,80,91]).
carta(31,10, [4,13,24,35,46,48,59,70,81,83]).
carta(32,10, [4,14,25,36,38,49,60,71,82,84]).
carta(33,10, [4,15,26,37,39,50,61,72,74,85]).
carta(34,10, [4,16,27,29,40,51,62,73,75,86]).
carta(35,10, [4,17,28,30,41,52,63,65,76,87]).
carta(36,10, [4,18,20,31,42,53,64,66,77,88]).
carta(37,10, [4,19,21,32,43,54,56,67,78,89]).
carta(38,10, [5,11,23,35,38,50,62,65,77,89]).
carta(39,10, [5,12,24,36,39,51,63,66,78,90]).
carta(40,10, [5,13,25,37,40,52,64,67,79,91]).
carta(41,10, [5,14,26,29,41,53,56,68,80,83]).
carta(42,10, [5,15,27,30,42,54,57,69,81,84]).
carta(43,10, [5,16,28,31,43,55,58,70,82,85]).
carta(44,10, [5,17,20,32,44,47,59,71,74,86]).
carta(45,10, [5,18,21,33,45,48,60,72,75,87]).
carta(46,10, [5,19,22,34,46,49,61,73,76,88]).
carta(47,10, [6,11,24,37,41,54,58,71,75,88]).
carta(48,10, [6,12,25,29,42,55,59,72,76,89]).
carta(49,10, [6,13,26,30,43,47,60,73,77,90]).
carta(50,10, [6,14,27,31,44,48,61,65,78,91]).
carta(51,10, [6,15,28,32,45,49,62,66,79,83]).
carta(52,10, [6,16,20,33,46,50,63,67,80,84]).
carta(53,10, [6,17,21,34,38,51,64,68,81,85]).
carta(54,10, [6,18,22,35,39,52,56,69,82,86]).
carta(55,10, [6,19,23,36,40,53,57,70,74,87]).
carta(56,10, [7,11,25,30,44,49,63,68,82,87]).
carta(57,10, [7,12,26,31,45,50,64,69,74,88]).
carta(58,10, [7,13,27,32,46,51,56,70,75,89]).
carta(59,10, [7,14,28,33,38,52,57,71,76,90]).
carta(60,10, [7,15,20,34,39,53,58,72,77,91]).
carta(61,10, [7,16,21,35,40,54,59,73,78,83]).
carta(62,10, [7,17,22,36,41,55,60,65,79,84]).
carta(63,10, [7,18,23,37,42,47,61,66,80,85]).
carta(64,10, [7,19,24,29,43,48,62,67,81,86]).
carta(65,10, [8,11,26,32,38,53,59,65,80,86]).
carta(66,10, [8,12,27,33,39,54,60,66,81,87]).
carta(67,10, [8,13,28,34,40,55,61,67,82,88]).
carta(68,10, [8,14,20,35,41,47,62,68,74,89]).
carta(69,10, [8,15,21,36,42,48,63,69,75,90]).
carta(70,10, [8,16,22,37,43,49,64,70,76,91]).
carta(71,10, [8,17,23,29,44,50,56,71,77,83]).
carta(72,10, [8,18,24,30,45,51,57,72,78,84]).
carta(73,10, [8,19,25,31,46,52,58,73,79,85]).
carta(74,10, [9,11,27,34,41,48,64,71,78,85]).
carta(75,10, [9,12,28,35,42,49,56,72,79,86]).
carta(76,10, [9,13,20,36,43,50,57,73,80,87]).
carta(77,10, [9,14,21,37,44,51,58,65,81,88]).
carta(78,10, [9,15,22,29,45,52,59,66,82,89]).
carta(79,10, [9,16,23,30,46,53,60,67,74,90]).
carta(80,10, [9,17,24,31,38,54,61,68,75,91]).
carta(81,10, [9,18,25,32,39,55,62,69,76,83]).
carta(82,10, [9,19,26,33,40,47,63,70,77,84]).
carta(83,10, [10,11,28,36,44,52,60,68,76,84]).
carta(84,10, [10,12,20,37,45,53,61,69,77,85]).
carta(85,10, [10,13,21,29,46,54,62,70,78,86]).
carta(86,10, [10,14,22,30,38,55,63,71,79,87]).
carta(87,10, [10,15,23,31,39,47,64,72,80,88]).
carta(88,10, [10,16,24,32,40,48,56,73,81,89]).
carta(89,10, [10,17,25,33,41,49,57,65,82,90]).
carta(90,10, [10,18,26,34,42,50,58,66,74,91]).
carta(91,10, [10,19,27,35,43,51,59,67,75,83]).


%RETORNA LA CANTIDAD DE CARTAS A PARTIR DE CANTIDAD DE ELEMENTOS POR CARTA 
f(NumE,MaxC):-
    MaxC is ((NumE-1) * (NumE-1)) + (NumE-1) + 1. 


%FUNCION SI ELEMNTO X PERTENECE A LA LISTA 
mymember(X,[X|_]) :- !.
mymember(X,[_|T]) :- mymember(X,T).

not(A) :- \+ call(A).

set([],[]).
set([H|T],[H|Out]) :-
    not(mymember(H,T)),
    set(T,Out).
set([H|T],Out) :-
    mymember(H,T),
    set(T,Out).

%ROTAR LA LISTA VAJO EL X NUMBER DENTRO DEL RANGO 
rotar(X,X,0):-!.
rotar([X|Y], L, N):- 
    N1 is N-1, 
    append(Y,[X],Y1), 
    rotar(Y1, L, N1).

%RETONRA BOOLEAN SI EL ELMENTOS ESTA REPETIDO EN LA LISTA
notRepetido([]):-!.
notRepetido([ILista|ICola]):-
    not(mymember(ILista,ICola)), 
    notRepetido(ICola).



%OBTIENE UN ELEMENTO DE LA LISTA DONDE INDICE => 1
getElement([Resultado|_],1,Resultado) :- !.
getElement([_|Cola],IndiceAbuscar,Resultado) :-
    IndiceAbuscar > 1, 
    IndiceActual is IndiceAbuscar-1,
    getElement(Cola,IndiceActual,Resultado).


%OBTIENE UN ELEMENTO DE LA LISTA DONDE INDICE => 0
getElement0([Resultado|_],0,Resultado) :- !.
getElement0([_|Cola],IndiceAbuscar,Resultado) :-
    IndiceAbuscar > 0, 
    IndiceActual is IndiceAbuscar-1,
    getElement0(Cola,IndiceActual,Resultado).


%CREA UNA LISTA A PARTIR DE SUB INDICES 
%rem([0,2,5],3,[a,b,c,d,s,f],K).
rem(_,0,_,[]) :- !.
rem([ICabeza|ICola], Hasta , Elementos , [Elemento|R] ) :- 
    Hasta > 0,
    getElement(Elementos,ICabeza,Elemento), 
    Acum is Hasta-1, 
    rem(ICola, Acum, Elementos , R ).
      



%generarCarta([a,b,c,d,s,f,j,y,t],2,1,C).
generarCarta(Elementos, NumE, MaxC, CartaNueva):-
   carta(MaxC,NumE,Carta), 
   rem(Carta,NumE,Elementos,CartaNueva). 


generarMazo(_,_,0,[]) :- !.
generarMazo(Elementos, NumE, MaxC, [Carta|Cartas]):-
    MaxC >= 0, 
    generarCarta(Elementos, NumE, MaxC, Carta), 
    SiguienteCarta is MaxC-1, 
    generarMazo(Elementos, NumE, SiguienteCarta, Cartas).



%cardsSet([ "A","B", "C", "D", "E", "F" ,"G" ], 3, 7, 1323 , CS ) 
cardsSet(Elementos, NumE, MaxC, Seed , CS ) :-
    MaxC =< 10,
    number(Seed), 
    random_between(1,MaxC,Rotacion),  
    generarMazo(Elementos, NumE, MaxC, CardsSet), 
    rotar(CardsSet, CS, Rotacion). 


%cardsSet([ "A","B", "C", "D", "E", "D" ,"G" ], 3, 7, 1323 , CS ), cardsSetIsDobble(CS).
cardsSetIsDobble([]):-!.
cardsSetIsDobble([Carta|CardsSet]):- 
    notRepetido(Carta), 
    cardsSetIsDobble(CardsSet).



%cardsSet([ "A","B", "C", "D", "E", "F" ,"G" ], 3, 7, 1323 , CS ), cardsSetNthCard(CS, 4, Carta).
cardsSetNthCard(CardsSet, Indice, Carta):-
    getElement0(CardsSet, Indice, Carta).



mergeList([],_,[]):-!.
mergeList([Car|Cdr],Caracter, [Car,Caracter|Resultado] ):-
    mergeList(Cdr, Caracter , Resultado ).



cardString(Carta, CardString ):- 
    mergeList(Carta,"-",CartaSeparda),  
    atomics_to_string(CartaSeparda, CardStringSola), 
    atom_concat(" carta: ",CardStringSola,CardString). 



cardsSetToFormat([],[]):-!.
cardsSetToFormat([Carta|CardsSet], [String|Resultado] ):- 
    cardString(Carta, String ),
    cardsSetToFormat(CardsSet, Resultado ).



%cardsSet([a, b, c, d, e, f, g, h, … ], 3, 3, 92175, CS), cardsSetToString(CS, CS_STR), write(CS_STR).
cardsSetToString(CardsSet, String):- 
    cardsSetToFormat(CardsSet, CardsString ),
    atomics_to_string(CardsString,String).


unionList(_,[],_):-!.
unionList([CL1|DL1],[CL2|DL2], [CL1,CL2|Resultado] ):-
    unionList(DL1,DL2, Resultado).


getElementByCardsSet([],_):-  !.

getElementByCardsSet([Card|CardsSet] ,[Elemento|_] ) :- 
    cardsSetNthCard(CardsSet,0,SegundaCarta),
    unionList(Card,SegundaCarta,Elemento),
    getElementByCardsSet(CardsSet,Elemento).



unir([],[],_):-!.
unir([Car|Cdr],[Car2|Cdr2],[Car,Car2|Resultado]):-
    unir(Cdr,Cdr2, Resultado ).


unir2(Lista,_):- length(Lista,Cantidad), Cantidad = 0, !.

unir2([Lista|Listas],Resultado):-
    getElement0(Listas,0,Carta),  
    unir(Lista,Carta,Resultado), 
    unir2(Listas, Resultado ).


%cardsSet([a, b, c, d, e, f, g, h ], 3, 3, 92175, CS), cardsSetMissingCards( CS, CS3).
%cardsSetMissingCards(CardsSet, CardsSet):- 




%cardsSet([a, b, c, d, e, f, g, h], 3, 3, 92175, CS), cardsSetNthCard(  CS, 2, C2), cardsSetFindTotalCards( C2, TC).
cardsSetFindTotalCards(Carta, TC ):-
    length(Carta,Cantidad),
    f(Cantidad,TC).




%TDA JUEGO


dobbleGame(NumPlayers, CardsSet, Mode, Seed, [NumPlayers, CardsSet, Mode, Seed] ). 


getNumPlayer([NumPlayers,_,_,_], NumPlayers). 

getCardsSetByGame([_,CardsSet,_,_], CardsSet).

getModeGame([_,_,Mode,_], Mode).

getSeedGame([_,_,_,Seed], Seed).



dobbleGameRegister(Usuario, DobbleGame, [ [Usuario|_] , DobbleGame ]). 


 

%dobbleGameWhoseTurnIsIt():-!.

%dobbleGamePlay():-.!

%dobbleGameStatus():-.!

%dobbleGameScore():-.!

%dobbleGameToString():-.!

